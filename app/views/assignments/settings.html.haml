.small-12.panel.mainContent
  = content_nav_for Assignment, "#{term_for :assignment} Settings"

  %h3.pagetitle= @title

  
  .small-12.medium-6.right.columns
    .button-bar.right
      %ul.button-group.context_menu
        %li
          %a{:href => new_assignment_path }
            %i.fi-plus
            New #{term_for :assignment}

  .small-12.columns
    
    .assignments
      - @assignments.group_by(&:assignment_type).each do |assignment_type, assignments|
        .assignment_type{:id => "assignment-type-#{assignment_type.id}" }
          %h3.collapse= "#{assignment_type.name} â€“ #{points assignment_type.max_value} points"
          %div
            .small-3.right
              .button-bar.aindex
                %ul.button-group.radius.right
                  %li.button.tiny
                    %i.fi-graph-trend
                    = link_to "Grade Patterns", all_grades_assignment_type_path(assignment_type)
                  %li.button.tiny
                    %i.fi-pencil
                    = link_to "Edit #{ assignment_type.name }", edit_assignment_type_path(assignment_type)
            %table.responsive
              %thead
                %tr
                  %th Name
                  %th Description
                  %th
                    %span.has-tip.tip-top{:title => "Visible to Students", :data => {'tooltip' => true}}
                      %i.fi-eye
                  %th
                    %span.has-tip.tip-top{:title => "Required", :data => {'tooltip' => true}}
                      *
                  %th
                    %span.has-tip.tip-top{:title => "Accepts Submissions", :data => {'tooltip' => true}}
                      %i.fi-paperclip
                  %th
                    %span.has-tip.tip-top{:title => "Shown in Timeline", :data => {'tooltip' => true}}
                      %i.fi-layout
                  %th
                    %span.has-tip.tip-top{:title => "Shown in Predictor", :data => {'tooltip' => true}}
                      %i.fi-checkbox
                  %th
                    %span.has-tip.tip-top{:title => "Shown in Due This Week", :data => {'tooltip' => true}}
                      %i.fi-calendar
                  %th
                    %span.has-tip.tip-top{:title => "Logged By Students", :data => {'tooltip' => true}}
                      %i.fi-pencil
                  %th
                    %span.has-tip.tip-top{:title => "Release Required", :data => {'tooltip' => true}}
                      %i.fi-unlock
                  %th
                    %span.has-tip.tip-top{:title => "Notify Students on Release", :data => {'tooltip' => true}}
                      %i.fi-mail
                  %th Grading
                  %th Points

                  %th Dates
                  %th 
              %tbody
                - assignments.each do |assignment|
                  %tr
                    %td= link_to assignment.name, assignment
                    %td= raw assignment.description
                    %td
                      - if assignment.visible?
                        %span.has-tip.tip-top{:title => "Visible to Students", :data => {'tooltip' => true}}
                          %i.fi-eye
                    %td
                      - if assignment.required?
                        %span.has-tip.tip-top{:title => "Required", :data => {'tooltip' => true}}
                          *
                    %td
                      - if assignment.accepts_submissions?
                        %span.has-tip.tip-top{:title => "Accepts Submissions", :data => {'tooltip' => true}}
                          %i.fi-paperclip
                    %td
                      - if assignment.include_in_timeline?
                        %span.has-tip.tip-top{:title => "Shown in Timeline", :data => {'tooltip' => true}}
                          %i.fi-layout
                    %td
                      - if assignment.include_in_predictor?
                        %span.has-tip.tip-top{:title => "Shown in Predictor", :data => {'tooltip' => true}}
                          %i.fi-checkbox
                    %td 
                      - if assignment.assignment_type.include_in_to_do?
                        %span.has-tip.tip-top{:title => "Shown in Due This Week", :data => {'tooltip' => true}}
                          %i.fi-calendar
                    %td
                      - if assignment.student_logged?
                        %span.has-tip.tip-top{:title => "Logged By Students", :data => {'tooltip' => true}}
                          %i.fi-pencil
                    %td
                      - if assignment.release_necessary?
                        %span.has-tip.tip-top{:title => "Release Required", :data => {'tooltip' => true}}
                          %i.fi-unlock
                    %td
                      - if assignment.notify_released?
                        %span.has-tip.tip-top{:title => "Notify Students on Release", :data => {'tooltip' => true}}
                          %i.fi-mail
                    %td
                      - if assignment.grade_select?
                        = select_tag(:score_levels, options_from_collection_for_select(assignment.score_levels_set, :value, :name))
                      - elsif assignment.grade_radio?
                        - assignment.score_levels_set.each do |asl|
                          = radio_button_tag(asl.name, asl.value)
                          %span.not_bold= label_tag(asl.name)
                          %br
                      - elsif assignment.grade_checkboxes?
                        = check_box_tag 'score'
                      - else
                        = text_field_tag 'score'
                    %td= points assignment.point_total
                    %td
                      %ul
                        %li 
                          Opens:
                          = assignment.try(:opens_at) || "Always Open"
                        %li
                          Due:
                          = assignment.try(:due_at) || "Ongoing"
                        %li
                          Accepted Until:
                          = assignment.try(:accept_until) || "Always Accepted"
                    %td 
                      .button-bar
                        %ul.button-group.right.round
                          %li
                            %a.button{:href => edit_assignment_path(assignment) }
                              Edit
                          %li
                            %a.button{:href => assignment_path(assignment), :data => { confirm: 'Are you sure?', method: :delete } }
                              Delete